function RandomNumber(e,t,n){return t=t||0,(n=n||!1)?Math.floor(Math.random()*(e-t)+t):Math.random()*(e-t)+t}function Round(e){return Math.round(1e3*e)/1e3}function GetViewbox(e){e.style.position="absolute",e.style.width="1px",e.style.height="1px",e.style.padding="0",e.style.margin="-1px",e.style.overflow="hidden",e.style.clip="rect(0,0,0,0)",e.style.border="0",document.body.appendChild(e);var t=e.getBBox();return e.removeAttribute("style"),e.remove(),t.x+" "+t.y+" "+t.width+" "+t.height}function RandomPendulum(){return{amplitude:200,frequency:RandomNumber(4,2,!0)+RandomNumber(.02,-.02),phase:RandomNumber(0,Math.PI),damping:RandomNumber(0,.01)}}function HarmonographBezierPath(e){for(var t={x:[],y:[],cpX:[],cpY:[]},n=e.x.length,r=0;r<n;r+=50){t.x.push(Round(e.x[r])),t.y.push(Round(e.y[r]));var o=r<=0?0:r-1,u=n<=r?n-1:r+1,a=25/3*(e.x[u]-e.x[o]),d=25/3*(e.y[u]-e.y[o]);t.cpX.push(a),t.cpY.push(d)}var p=["M",t.x[0],t.y[0],"C",Round(t.x[0]+t.cpX[0]),Round(t.y[0]+t.cpY[0])+",",Round(t.x[1]-t.cpX[1]),Round(t.y[1]-t.cpY[1])+",",t.x[1],t.y[1]],i=t.x.length;if(2<i){p.push("S");for(r=2;r<i;r++)p.push(Round(t.x[r]-t.cpX[r])),p.push(Round(t.y[r]-t.cpY[r])+","),p.push(Round(t.x[r])),p.push(Round(t.y[r]))}return p.join(" ")}function GenerateHarmonograph(e,t,n){for(var r=0,o=0,u={x:[],y:[]};r<60*e;){r++;var a=n.map(function(e){return e.amplitude*Math.sin(e.frequency*o+e.phase)*Math.exp(-e.damping*o)}),d=a[0]+a[1],p=a[2]+a[3];u.x.push(d+t/2),u.y.push(p+t/2),o+=.01}return u}function Harmonograph(e){var t=e||{},n=t.size?t.size:700,r=t.strokewidth?t.strokewidth:1,o=t.strokeColor?t.strokeColor:"#000",u=HarmonographBezierPath(GenerateHarmonograph(t.pendulumTime?t.pendulumTime:150,n,t.pendulum?t.pendulum:[RandomPendulum(),RandomPendulum(),RandomPendulum(),RandomPendulum()])),a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("xlms","http://www.w3.org/2000/svg");var d=document.createElementNS("http://www.w3.org/2000/svg","path");return d.setAttribute("d",u),d.setAttribute("stroke",o),d.setAttribute("stroke-width",r),d.setAttribute("fill","none"),a.appendChild(d),a.setAttribute("viewBox",GetViewbox(a)),a}